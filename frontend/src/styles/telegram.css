/* ===== TELEGRAM WEBAPP OPTIMIZATIONS ===== */

/* Telegram viewport and safe area handling */
@supports (padding: max(0px)) {
  .casino-app {
    padding-left: max(var(--tg-safe-area-inset-left), env(safe-area-inset-left));
    padding-right: max(var(--tg-safe-area-inset-right), env(safe-area-inset-right));
  }
  
  .game-header {
    padding-left: max(var(--space-md), var(--tg-safe-area-inset-left));
    padding-right: max(var(--space-md), var(--tg-safe-area-inset-right));
  }
  
  .player-nav {
    padding-left: max(var(--space-md), var(--tg-safe-area-inset-left));
    padding-right: max(var(--space-md), var(--tg-safe-area-inset-right));
  }
  
  .player-content {
    padding-left: max(var(--space-md), var(--tg-safe-area-inset-left));
    padding-right: max(var(--space-md), var(--tg-safe-area-inset-right));
  }
  
  .game-controls {
    padding-left: max(var(--space-md), var(--tg-safe-area-inset-left));
    padding-right: max(var(--space-md), var(--tg-safe-area-inset-right));
    padding-bottom: max(var(--space-md), var(--tg-safe-area-inset-bottom));
  }
  
  .admin-sidebar {
    padding-left: max(var(--space-lg), var(--tg-safe-area-inset-left));
    padding-top: max(var(--space-lg), var(--tg-safe-area-inset-top));
  }
  
  .admin-main {
    padding-left: max(var(--space-lg), var(--tg-safe-area-inset-left));
    padding-right: max(var(--space-lg), var(--tg-safe-area-inset-right));
  }
}

/* Telegram WebApp theme support */
.telegram-theme-dark {
  --tg-theme-bg-color: #182333;
  --tg-theme-text-color: #ffffff;
  --tg-theme-hint-color: #999999;
  --tg-theme-link-color: #2481cc;
  --tg-theme-button-color: #2481cc;
  --tg-theme-button-text-color: #ffffff;
}

.telegram-theme-light {
  --tg-theme-bg-color: #ffffff;
  --tg-theme-text-color: #000000;
  --tg-theme-hint-color: #999999;
  --tg-theme-link-color: #2481cc;
  --tg-theme-button-color: #2481cc;
  --tg-theme-button-text-color: #ffffff;
}

/* Apply Telegram theme colors if available */
body {
  background-color: var(--tg-theme-bg-color, var(--dark-bg));
  color: var(--tg-theme-text-color, var(--text-primary));
}

/* Telegram WebApp specific adjustments */
.telegram-webapp {
  /* Prevent zoom on input focus (iOS Safari) */
  -webkit-text-size-adjust: 100%;
  -ms-text-size-adjust: 100%;
  
  /* Better touch targets */
  touch-action: manipulation;
  
  /* Smooth scrolling for better UX */
  -webkit-overflow-scrolling: touch;
  scroll-behavior: smooth;
}

/* Optimized scrolling for Telegram WebApp */
.casino-app,
.player-content,
.admin-main,
.game-table {
  -webkit-overflow-scrolling: touch;
  scroll-behavior: smooth;
  overscroll-behavior: contain;
}

/* Better button feedback for touch */
.game-btn,
.control-btn,
.quick-bet,
.admin-nav-link,
.player-nav a {
  touch-action: manipulation;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
  user-select: none;
  -webkit-user-select: none;
}

/* Prevent text selection on game elements */
.cards-area,
.game-table,
.dealer-section,
.player-section {
  user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}

/* Optimized modal for Telegram WebApp */
.modal {
  padding: var(--tg-safe-area-inset-top) var(--tg-safe-area-inset-right) var(--tg-safe-area-inset-bottom) var(--tg-safe-area-inset-left);
}

.modal-content {
  max-height: calc(90vh - var(--tg-safe-area-inset-top) - var(--tg-safe-area-inset-bottom));
  margin: var(--space-md);
  margin-top: max(var(--space-md), var(--tg-safe-area-inset-top));
}

/* Telegram WebApp viewport fixes */
@media screen and (max-height: 600px) {
  .game-header {
    padding-top: var(--space-xs);
    padding-bottom: var(--space-xs);
  }
  
  .player-nav {
    padding-top: var(--space-xs);
    padding-bottom: var(--space-xs);
  }
  
  .game-controls {
    padding-top: var(--space-xs);
    padding-bottom: var(--space-xs);
  }
  
  .game-btn {
    height: clamp(40px, 10vh, 48px);
  }
  
  .start-btn {
    height: clamp(44px, 12vh, 52px);
  }
}

@media screen and (max-width: 400px) {
  .game-table {
    padding: var(--space-sm);
  }
  
  .cards-area {
    padding: var(--space-xs);
  }
  
  .betting-section {
    padding: var(--space-sm);
  }
  
  .game-controls {
    padding: var(--space-sm);
  }
}

/* Telegram WebApp performance optimizations */
.casino-app {
  will-change: transform;
  contain: layout style paint;
}

.card {
  will-change: transform;
  contain: layout style paint;
}

.game-btn {
  will-change: transform;
  contain: layout style paint;
}

/* Prevent layout shift on load */
.casino-app {
  min-height: 100vh;
  overflow-x: hidden;
}

/* Better focus handling for keyboard navigation */
.game-btn:focus,
.control-btn:focus,
.quick-bet:focus,
input:focus,
select:focus,
textarea:focus {
  outline: 2px solid var(--tg-theme-link-color, var(--primary));
  outline-offset: 2px;
}

/* High contrast mode support */
@media (prefers-contrast: high) {
  .game-btn,
  .control-btn,
  .quick-bet {
    border-width: 2px;
  }
  
  .card {
    border-width: 3px;
  }
  
  .game-table {
    border-width: 2px;
  }
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
  .card,
  .game-btn,
  .control-btn,
  .quick-bet {
    animation: none;
    transition: none;
  }
  
  .win-effects {
    display: none;
  }
}