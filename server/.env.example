# ===== BLACKJACK CASINO - ENVIRONMENT CONFIGURATION =====
# Copy this file to .env and fill in your actual values

# ===== ОСНОВНАЯ КОНФИГУРАЦИЯ =====
NODE_ENV=production
PORT=3000

# ===== БЕЗОПАСНОСТЬ =====
# JWT secret для подписи токенов (использовать сильный случайный ключ)
JWT_SECRET=replace-with-strong-secret-minimum-32-characters

# ===== БАЗА ДАННЫХ =====
# PostgreSQL строка подключения
DATABASE_URL=postgresql://username:password@localhost:5432/blackjack_casino_production
# SSL режим для подключения: disable | no-verify | require
DATABASE_SSL_MODE=disable
# (опционально) путь к файлу CA или инлайн сертификат для self-signed
# DATABASE_SSL_CERT_FILE=certs/postgres-ca.pem
# DATABASE_SSL_CERT="-----BEGIN CERTIFICATE-----..."

# ===== REDIS =====
# Redis для очередей и кеширования
REDIS_URL=redis://localhost:6379
# Включите true если провайдер требует TLS (например, rediss://)
REDIS_TLS=false

# ===== TELEGRAM КОНФИГУРАЦИЯ =====
# Bot token от @BotFather
TELEGRAM_BOT_TOKEN=your_telegram_bot_token_here
# Provider token для Telegram Stars (оставить пустым для цифровых товаров)
TELEGRAM_PROVIDER_TOKEN=your_telegram_provider_token

# ===== АДМИНИСТРАТИВНЫЙ ДОСТУП =====
# Telegram ID администраторов (через запятую)
ADMIN_TELEGRAM_IDS=123456789,987654321
# Пароль для входа в админ панель
ADMIN_PANEL_SECRET=set-strong-password
# Вместо пароля можно указать путь до файла или заранее посчитанный хэш (опционально)
# ADMIN_PANEL_SECRET_FILE=/secure/path/admin_secret.txt
# ADMIN_PANEL_SECRET_HASH=sha256:...

# ===== CRYPTOMUS ПЛАТЕЖИ =====
# Merchant ID и API ключ от Cryptomus
CRYPTOMUS_MERCHANT_ID=your_cryptomus_merchant_id
CRYPTOMUS_API_KEY=your_cryptomus_api_key
# URL для Cryptomus API (по умолчанию используются стандартные)
CRYPTOMUS_PAYMENT_URL=https://api.cryptomus.com/v1/payment
CRYPTOMUS_STATUS_URL=https://api.cryptomus.com/v1/payment/info
CRYPTOMUS_PAYOUT_URL=https://api.cryptomus.com/v1/payout
CRYPTOMUS_PAYOUT_STATUS_URL=https://api.cryptomus.com/v1/payout/info
# Webhook URL для уведомлений от Cryptomus
CRYPTOMUS_WEBHOOK_URL=https://yourdomain.com/api/payments/cryptomus/webhook

# ===== БЕЗОПАСНОСТЬ API =====
# Лимит запросов в минуту на IP
REQUEST_LIMIT_PER_MINUTE=120
# Whitelist IP адресов (через запятую, опционально)
IP_WHITELIST=
# Разрешенные CORS-origin'ы для админки/клиента (через запятую)
ALLOWED_ORIGINS=https://yourdomain.com,https://admin.yourdomain.com
# Разрешенные домены для верификации (опционально, через запятую)
VERIFICATION_ALLOWED_HOSTS=yourdomain.com
# TTL сессии администратора (в секундах)
ADMIN_SESSION_TTL_SECONDS=3600
# Максимальный возраст initData от Telegram (в секундах)
TELEGRAM_INIT_MAX_AGE_SECONDS=60
# TTL для переиспользования initData в Redis (в секундах)
TELEGRAM_INIT_REUSE_TTL_SECONDS=3600
# Доверять X-Forwarded-* заголовкам (true/false/number/список сабнетов)
TRUST_PROXY=true

# ===== NGROK РЕЖИМ (ОПЦИОНАЛЬНО) =====
# Включить режим ngrok для автоматического обхода заглушки Visit Site
NGROK_MODE=false
# Кастомное имя заголовка / query-параметра для пропуска (опционально)
NGROK_SKIP_HEADER=ngrok-skip-browser-warning
NGROK_SKIP_QUERY=ngrok-skip-browser-warning

# ===== ДОПОЛНИТЕЛЬНЫЕ НАСТРОЙКИ ДЛЯ PM2 =====
# Эти переменные используются в ecosystem.config.js для workers
# но основная логика настраивается через админ панель

# Telegram webhook URL для production
TELEGRAM_WEBHOOK_URL=https://yourdomain.com/api/telegram/webhook

# Настройки игры (используются в PM2, но могут быть переопределены в админке)
HOUSE_EDGE=0.005
MAX_BET=1000
MIN_BET=10

# Настройки антифрода (используются в PM2, основная логика в админке)
VELOCITY_LIMIT_GAMES_PER_HOUR=100
DAILY_PROFIT_LIMIT=10000

# Настройки crypto батчинга (используются в PM2, основная логика в админке)
CRYPTO_BATCH_SIZE=10
CRYPTO_BATCH_INTERVAL_MINUTES=60
CRYPTO_AUTO_APPROVAL_THRESHOLD=100
CRYPTO_URGENT_FEE_MULTIPLIER=2.0

# ===== ТЕСТИРОВАНИЕ =====
# Для тестов (опционально)
TEST_DATABASE_URL=postgresql://username:password@localhost:5432/blackjack_casino_test
KNEX_ENV=test
